function lcz(){var _this=this;this.geci_object,this.geci_lines,this.upkp,this.classV1,this.classV2,this.initTop,this.center,this.empty,this.isDropgeci,this.width,this.height,this.align,this.oneline,this.luminous,this.change,this.staue=!0,this.tag={},this.mould='<ul style="height: 184px;list-style: none;position: relative;line-height: 30px;padding: 0 15px;overflow-y: hidden;display:none;"></ul>',this.getgeci="Value";var errmsg="程序发生异常，无法继续了！";this.toTimer=function(e){var t,n;return t=Math.floor(e/60),t=isNaN(t)?"--":t>=10?t:"0"+t,n=Math.floor(e%60),n=isNaN(n)?"--":n>=10?n:"0"+n,t+":"+n},this.addgeci=function(e,t,n){var r=document.createElement("li");r.innerHTML=t?t:"",r.className=e?e:"",r.lang=n?n:"",this.geci_object.appendChild(r),this.geci_lines.push(r)},this.getgeciByValue=function(e){le=this.geci_lines.length,e="^"+e+".*";for(var t=0;t<le;t++){if(this.geci_lines[t].lang.search(e)==0){return this.geci_lines[t]}}return null},this.getgeciByValueInd=function(e){le=this.geci_lines.length-1;for(var t=le;t>=0;t--){p=this.geci_lines[t].lang;if(p&&p<e){return this.geci_lines[t]}}return null},this.setClassName=function(e,t){e&&(e.className=t)},this.upTop=function(e){var t=e.offsetTop,n=this.geci_object.scrollTop,r=t-this.center;this.myf(this.geci_object,n,r)},this.remove=function(){if(this.geci_lines!=null){for(var e=0;e<this.geci_lines.length;e++){this.geci_object.removeChild(this.geci_lines[e])}}this.geci_lines=new Array,!this.empty&&this.empty!=0&&alert("empty 属性有误! 该值必须>=零")},this.load=function(json,fun){gecis=json.gecis,end=json[this.tag.end];with(this){remove(),_addgeci(json[this.tag.sname]),_addgeci(json[this.tag.cname]),_addgeci(json[this.tag.qname]),_addgeci(json[this.tag.bname]),_addgeci(json[this.tag.sgname]),_addgeci(json[this.tag.special]),_addgeci(json[this.tag.kname])}if(gecis){for(var index in gecis){this.addgeci(this.classV1,gecis[index].name,gecis[index].time)}}end&&(end.time?this.addgeci(this.classV1,end.end,end.time):this.addgeci(this.classV1,end)),typeof fun=="function"&&fun.call(null,null)},this._addgeci=function(e){e&&(e.time?this.addgeci(this.classV1,e.name,e.time):this.addgeci(this.classV1,e))},this.Read=function(e,t){if(t!=null&&typeof t=="function"){return t.call(this,e)}var n={};n.gecis=new Array;var r=e.split("["),i=r.length;for(var s=0;s<i;s++){var o=r[s],u=o.split("]");if(u.length==2){if(u[0].search("^[0-9]{2}:[0-9]{2}.[0-9]{1,3}$")<0){title=u[0].split(":"),n=tagswitch(title,n)}else{var a={time:u[0],name:u[1]};n.gecis.push(a)}}}return n},this.vls1=function(e){var n={};n.gecis=new Array;var r=e.length,i=0,s=0,o=new Array;for(var u=0;u<r;u++){e[u]=="["&&u>8&&(e.slice(u-9,u-1)+"").search("^[0-9]{2}:[0-9]{2}.[0-9]{1,3}$")<0&&(o.push(e.substring(i,u)),i=u)}o.push(e.substring(i,r));var a={},f=[];for(var u=0;u<o.length;u++){var l=o[u],c=l.split("]");if(c.length===2){(c[0]+"").search("^\\[[0-9]{2}:[0-9]{2}.[0-9]{1,3}$")<0?(c[0]=c[0].slice(1),title=c[0].split(":"),n=tagswitch(title,n)):(h=c[0].slice(1)+"",a[h]=c[1],f.push(h))}else{if(c.length>2){var h,e;e=c[c.length-1];for(var p in c){c[p].search("^\\[[0-9]{2}:[0-9]{2}.[0-9]{1,3}$")==0&&(h=c[p].slice(1)+"",a[h]=e,f.push(h))}}}}f=f.sort();for(var p in f){t=f[p];var d={time:t,name:a[t]};n.gecis.push(d)}return n};var tagswitch=function(e,t){e.length===2&&(tp=e[1]),tag=_this.tag;switch(e[0]){case tag.sname:t[tag.sname]=tp;break;case tag.cname:t[tag.cname]=tp;break;case tag.qname:t[tag.qname]=tp;break;case tag.bname:t[tag.bname]=tp;break;case tag.sgname:t[tag.sgname]=tp;break;case tag.special:t[tag.special]=tp;break;case tag.kname:t[tag.kname]=tp;break;case tag.end:t[tag.end]=tp}return t};this.myf_Init=function(){this.geci_object.innerHTML=this.mould,asc=this.geci_object=this.geci_object.firstChild,asc.style.width=this.width,asc.style.height=this.height,asc.style.textAlign=this.align,this.oneline?(this.empty=0,this.center=5):(this.empty=5,this.center=this.geci_object.style.height/2|120),this.isDropgeci&&this.logon(!1)},this.setoccupy=function(e,t){e.style.display="block",this.setClassName(e,this.classV2),this.upTop(e),this.upkp&&this.unoccupy(this.upkp),this.upkp=e,t&&t(e)},this.unoccupy=function(e,t){this.setClassName(e,this.classV1),this.oneline&&(e.style.display="none"),t&&t(e)},this.torun=function(time){if(!this.staue){return !1}var time=this.toTimer(Math.round((time|event.srcElement.currentTime)*100)/100),line=eval("this.getgeciBy"+this.getgeci+"(time)");line&&this.upkp!=line&&this.setoccupy(line)},this.logon=function(e){if(window.FileReader){var t=this.geci_object;e&&(t=document.getElementById(e));function n(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files;for(var n=0,r;r=t[n];n++){var i=new FileReader;i.onloadend=function(e){return function(e){img=e.target.result,img&&_this.load(_this.Read(img))}}(r),i.readAsText(r)}}function r(e){}function i(e){}function s(e){e.stopPropagation(),e.preventDefault()}t.addEventListener("dragenter",r,!1),t.addEventListener("dragover",s,!1),t.addEventListener("drop",n,!1),t.addEventListener("dragleave",i,!1),t.addEventListener("ondragend",i,!1)}else{alert("你的浏览器不支持啊，同学")}};var timer=null;this.myf=function(e,t,n){timer!=null&&clearTimeout(timer),this.isUpOrDown(e,t,n)},getUpValue=function(e,t){return t-e>100?e+=30:t-e>50?e+=10:t-e>20?e+=5:t-e>1&&e++,e},getDowmValue=function(e,t){return e-t>100?e-=30:e-t>50?e-=10:e-t>20?e-=5:e-t>1&&e--,e},this.isUpOrDown=function(e,t,n){t<n?this.toUp(e,t,n):this.toDown(e,t,n)},this.toUp=function(e,t,n){timer=setInterval(function(){t>=n&&(clearTimeout(timer),timer=null,e.scrollTop=n),e.scrollTop=t,t=getUpValue(t,n)},10)},this.toDown=function(e,t,n){timer=setInterval(function(){t<=n&&(clearTimeout(timer),timer=null,e.scrollTop=n),e.scrollTop=t,t=getDowmValue(t,n)},30)},this.destory=function(){}}geci={msg:{ms1:"元素位置没有给出！ error : 103",ms2:"请给出歌词的链接地址，或文本内容！ error : 105"},tag:{sname:"ti",cname:"cl",qname:"cs",bname:"ps",sgname:"ar",special:"al",kname:"by",end:"end"},build:function(e,d){var f=new lcz;return f.tag=geci.tag,e.object?f.geci_object=document.getElementById(e.object):alert(geci.msg.ms1),f.initTop=e.initTop!=null?e.initTop:0,f.center=e.center!=null?e.center:0,f.empty=e.empty!=null?e.empty:0,f.isDropgeci=e.isDropgeci!=null?e.isDropgeci:!0,f.getgeci=e.seekMark!=null?e.seekMark:"Value",d&&(f.classV1=d.notoccupy!=null?d.notoccupy:"geci_moonlight",f.classV2=d.occupy!=null?d.occupy:"geci_attention",f.width=d.width!=null?d.width:"550px",f.height=d.height!=null?d.height:"200px",f.align=d.align!=null?d.align:"left",f.oneline=d.oneline!=null?d.oneline:!1),f.myf_Init(),geci.readgeci(f,e.readType,{url:e.geciUrl?e.geciUrl:null,text:e.geciText?e.geciText:null},function(){f.geci_object.scrollTop=f.initTop,f.oneline&&(f.geci_object.className+=" geci_hide"),e.syntony&&e.syntony(f)})&&e.open&&geci.open(f),e.media&&(mp=document.getElementById(e.media),window.attachEvent?mp.attachEvent("ontimeupdate",function(){f.torun()}):mp.addEventListener("timeupdate",function(){f.torun()},!1)),f},readgeci:function(j,g,k,h){var e="";if(k.text){e=k.text}else{if(!k.url){return alert(geci.msg.ms2),!1}xmlhttp=null,window.XMLHttpRequest?xmlhttp=new XMLHttpRequest:window.ActiveXObject&&(xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")),xmlhttp!=null&&(xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4){if(xmlhttp.status==200){return e=xmlhttp.responseText,e=e.replace(/<\/?.+?>/g,"").replace(/[\r\n]/g,""),j.load(j.Read(e,g),h),!0}$("#lrc_2 ul").append('<li style="color: #69d2e7;">暂无歌词</li>')}},xmlhttp.open("GET",k.url,!0),xmlhttp.send(null))}return j.load(j.Read(e,g),h),!0},open:function(b){b.geci_object&&(b.geci_object.style.display="block"),b.staue=!0},close:function(b){b.geci_object&&(b.geci_object.style.display="none"),b.staue=!1},suspend:function(b){b.geci_object&&(b.staue=!1)},destroy:function(b){geci.close(b),b.remove(b.geci_object)},setProgress:function(d,c){d.torun(c)}};(function(a){var W=a("#key"),X=a(".play-list"),N=a("#audio"),O=a(".bg-player"),R=a(".cover-photo img"),V=a(".song-title"),U=a(".song-artist"),T=a(".album-name"),Q=a(".btn-play i"),P=a(".btn-download i");var u=0,s=0,e=N[0],J=localStorage.shuffle||"false";repeat=localStorage.repeat||0,continous=true,autoplay=true,trigger=false,timeout=false,time=new Date();var x,A,r,E,k,h;var w=W.data("api");if(W.attr("data-shuffle")=="true"){J=localStorage.shuffle="true"}else{J=localStorage.shuffle="false"}var G=function(ad,af){var j=[];var ae=JSON.parse(localStorage.getItem(ad));if(ae){for(var ac=0;ac<ae.length;ac++){if(af==ae[ac]){return}else{j=ae}}}j.push(af);localStorage.setItem(ad,JSON.stringify(j))};var m=function(ac){var j=JSON.parse(localStorage.getItem(ac));return j};var q=function(j,ad){var ac=","+j.join(",")+",";return ac.indexOf(","+ad+",")!=-1};var g=function(j){if(j===0){return"0B"}var ac=1024;sizes=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];i=Math.floor(Math.log(j)/Math.log(ac));return(j/Math.pow(ac,i)).toPrecision(3)+sizes[i]};var b=function(j){var ac='<script type="text/javascript">'+j+"</script>";W.html(ac)};var n=function(ac){X.html("");if(ac.length==0){X.append("<li>没有找到歌曲</li>")}else{for(var ad=0;ad<ac.length;ad++){var ae=ac[ad];var j=ae.artist.name_2==null?"":" & "+ae.artist.name_2;u=ad;u++;X.append('<li><span class="li-title">'+u+". "+ae.title+'</span> - <span class="li-artist">'+ae.artist.name_1+j+"</span></li>")}}};var y=function(){x.each(function(ac){var j=ac;a(this).on("click",function(){k=j;z(k)})})};var c=function(j){n(playlist);x=a(".play-list li");y();if(j==0){z(k)}};var D=function(){e.play();Q.attr("class","active ea-pause");timeout=setInterval(aa,500);r=true};var C=function(){e.pause();Q.attr("class","ea-play");clearInterval(aa);r=false};var M=function(j){if(j<0){track=k=playlist.length-1}else{if(j>=playlist.length){track=k=0}else{track=j}}z(track)};var K=function(){var ac=new Date(),j=k;k=ac.getTime()%playlist.length;if(j==k){++k}M(k)};var l=function(){C();e.currentTime=0;E++;if(continous==true){r=true}if(repeat==1){D()}else{if(J==="true"){K()}else{if(repeat==2){M(++k)}else{if(k<playlist.length){M(++k)}}}}};var d=function(){if(r==true){D()}};var o=function(){if(W.attr("data-autoplay")=="true"){setTimeout(function(){e.addEventListener("canplay",D(),false)},3000)}};var H=function(ah){var ac=parseInt(ah%60)<10?"0"+parseInt(ah%60):parseInt(ah%60),ae=ah/e.duration*100;var j=e.duration;var ag;if(!j){ag="loading..."}else{var ad=parseInt(j/60);var af=parseInt(j%60);ad=ad>=10?ad:"0"+ad;af=af>=10?af:"0"+af;ag="0"+parseInt(ah/60)+":"+ac+"/"+ad+":"+af}a(".progress-sider .sider-pace").css("width",ae+"%");a(".progress-sider a").css("left",ae+"%");a(".player-timer").html(ag)};var f=function(){var j=this.seekable&&this.seekable.length?this.seekable.end(0):0;a(".progress-sider .sider-loaded").css("width",(100/(this.duration||1)*j)+"%")};var aa=function(){H(e.currentTime)};a(".progress-sider").slider({step:0.1,slide:function(j,ac){a(this).addClass("enable");H(e.duration*ac.value/100);clearInterval(timeout)},stop:function(j,ac){e.currentTime=e.duration*ac.value/100;a(this).removeClass("enable");timeout=setInterval(aa,500)}});var I=function(j){e.volume=localStorage.volume=j;a(".volume-sider .sider-pace").css("width",j*100+"%");a(".volume-sider a").css("left",j*100+"%")};var ab=localStorage.volume||0.5;a(".volume-sider").slider({max:1,min:0,step:0.01,value:ab,slide:function(j,ac){I(ac.value);a(this).addClass("enable");a(".volume .volume-mute").removeClass("enable")},stop:function(){a(this).removeClass("enable")}}).children(".volume-sider .sider-pace").css("width",ab*100+"%");a(".volume-mute i").click(function(){if(a(this).hasClass("enable")){I(a(this).data("volume"));a(this).removeClass("enable ea-mute").addClass("ea-volume")}else{a(this).data("volume",e.volume).removeClass("ea-volume").addClass("enable ea-mute");I(0)}});var z=function(ac){var ad=playlist[ac];var j=ad.artist.name_2==null?"":" / "+ad.artist.name_2;var ae=w+"/api.php?action=lyric&id="+ad.tid+"&source="+ad.source;a.getJSON(w+"/api.php?action=cover&id="+ad.pid+"&source="+ad.source,function(af){R.attr("src",af.url);O.css("background-image","url("+af.url+")")});V.html(ad.title+" - ");U.html(ad.artist.name_1+j);T.html("《"+ad.album+"》");x.removeClass("playing").eq(ac).addClass("playing");a(".lyric-script").html('<script>geci.build({object:"lrc_2",media:"audio",geciUrl:"'+ae+'",readType:"vls1",open:true},{oneline:false,height:"350px",width:"auto"});</script>');a.getJSON(w+"/api.php?action=song&id="+ad.mid+"&source="+ad.source,function(af){N.attr("src",af.url);e.volume=a(".volume-mute i").hasClass("enable")?0:ab;e.addEventListener("progress",f,false);e.addEventListener("durationchange",f,false);e.addEventListener("ended",l,false);e.addEventListener("canplay",d,false);P.attr("title",g(af.size))});s=ac};var B=function(j,ac,ad){a.ajax({type:"GET",url:w+"/api.php",data:{action:"list",id:j,source:ac,type:ad},beforeSend:function(){X.html("<li>正在加载数据...</li>")},success:function(ae){b(ae);k=J==="true"?time.getTime()%playlist.length:0;c(0);A=ae;o()}});return};var F=function(j,ac){a.ajax({type:"GET",url:w+"/api.php",data:{action:"search",name:j,source:ac},beforeSend:function(){X.html("<li>正在加载数据...</li>")},success:function(ad){b(ad);k=J==="true"?time.getTime()%playlist.length:0;c(1)}})};a(".music-search-form").bind("submit",function(j){j.preventDefault();var ad=W.attr("data-search");var ac=a(".music-search-form .music-search-input").val();F(ac,ad)});a(".btn-play i").on("click",function(){if(Q.hasClass("active")){C()}else{D()}});a(".btn-prev i").on("click",function(){if(J==="true"){K()}else{M(--k)}});a(".btn-next i").on("click",function(){if(J==="true"){K()}else{M(++k)}});if(J=="true"){a(".btn-mode i").attr("class","ea-shuffle")}else{if(repeat==1){a(".btn-mode i").attr("class","ea-onec")}else{if(repeat==2){a(".btn-mode i").attr("class","ea-all")}}}a(".btn-mode i").on("click",function(){if(a(this).hasClass("ea-all")){J=localStorage.shuffle="true";repeat=localStorage.repeat=2;a(this).removeClass("ea-all").addClass("ea-shuffle")}else{if(a(this).hasClass("ea-shuffle")){J=localStorage.shuffle="false";repeat=localStorage.repeat=1;a(this).removeClass("ea-shuffle").addClass("ea-onec")}else{if(a(this).hasClass("ea-onec")){J=localStorage.shuffle="false";repeat=localStorage.repeat=2;a(this).removeClass("ea-onec").addClass("ea-all")}}}});a(".btn-download i").on("click",function(ac){var ad=document.createElement("iframe"),ae=playlist[s],j=ae.artist.name_2==null?"":"，"+ae.artist.name_2;ad.style.display="none";ad.src=w+"/dl.php?id="+ae.mid+"&source="+ae.source+"&name="+ae.artist.name_1+j+" - "+ae.title;document.body.appendChild(ad);setTimeout(function(){document.body.removeChild(ad)},3000)});a(".btn-enlarge i").on("click",function(j){if(a(this).hasClass("enable")){a(".player-hide-box").css("height","0px");a(this).removeClass("enable")}else{a(".player-hide-box").css("height","400px");a(this).addClass("enable")}});a(".btn-eaplayer").on("click",function(j){if(a(this).hasClass("enable")){a(".player-layer").css("left","-97%");a(this).removeClass("enable");a(".btn-eaplayer i").removeClass("ea-left").addClass("ea-right");if(a(".btn-enlarge i").hasClass("enable")){a(".player-hide-box").css("height","0px");a(".btn-enlarge i").removeClass("enable")}}else{a(".player-layer").css("left","0");a(this).addClass("enable");a(".btn-eaplayer i").removeClass("ea-right").addClass("ea-left")}});a(".empty-history").on("click",function(j){localStorage.removeItem("historyList");a(".history-list .temp-history").remove()});a(document).on("click","#eaplayer-button",function(){var ac=a(this).data("id"),ad=a(this).data("source"),ag=a(this).data("type"),af=a(this).data("title");var j='{"id":"'+ac+'","source":"'+ad+'","type":'+ag+',"title":"'+af+'"}';G("historyList",j);var ae=[];a(".history-list li").each(function(ah){var ai=a(this).attr("data-id");var aj=a(this).attr("data-type");ae[ah]=ai});if(q(ae,ac)){a(".history-list li").removeClass("now");a(".history-list li").each(function(ah){if(a(this).attr("data-id")==ac){a(this).addClass("now")}});B(ac,ad,ag)}else{a(".history-list li").removeClass("now");a(".history-list").append('<li class="temp-history now" data-id="'+ac+'" data-source="'+ad+'" data-type="'+ag+'">'+af+"</li>");B(ac,ad,ag)}});a(document).on("click",".history-list li",function(){a(".history-list li").removeClass("now");a(this).addClass("now");B(a(this).data("id"),a(this).data("source"),a(this).data("type"))});var S=W.attr("data-id");var Y=W.attr("data-source");var Z=W.attr("data-type");a(".history-list").append('<li class="now" data-id="'+S+'" data-source="'+Y+'" data-type="'+Z+'">「Welcome」默认的曲单</li>');B(S,Y,Z);var L=m("historyList");if(L){for(i=0;i<L.length;i++){var v=JSON.parse(L[i]);a(".history-list").append('<li class="temp-history" data-id="'+v.id+'" data-source="'+v.source+'" data-type="'+v.type+'">'+v.title+"</li>")}}console.log("%c 蜜汁路易 %c","background:#24272A; color:#ffffff","","https://www.cssplus.org");console.log("%c Github %c","background:#24272A; color:#ffffff","","https://github.com/0x0233")})(jQuery);